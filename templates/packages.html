{% extends 'base.html' %}
{% block content %}
<h2>Holiday Packages</h2>
<div class="mb-4" style="display:flex;gap:16px;">
    <button id="filter-with-flight" class="btn btn-outline-primary active" onclick="showFlightOption('with')">With Flight</button>
    <button id="filter-without-flight" class="btn btn-outline-primary" onclick="showFlightOption('without')">Without Flight</button>
</div>
<div class="row">
{% for p in packages %}
<div class="col-md-4">
<div class="card mb-4">
    <img src="{{ p.image }}" class="card-img-top">
    <div class="card-body">
        <h5>{{ p.name }}</h5>
        <p>{{ p.duration }} from {{ request.args.get('from_city', 'New Delhi') }} to {{ request.args.get('destination', p.destination) }}</p>
        <div class="mb-2 flight-option flight-option-with" style="background:#eaf4ff;border-radius:8px;padding:12px;">
            <div style="font-weight:600;color:#0077ff;">With Flight</div>
            <div style="font-size:1.25rem;font-weight:700;">₹{{ "{:,}".format(package_prices[p.id]['with_flight']) }}</div>
            <a href="/package/{{ p.id }}?from_city={{ request.args.get('from_city', 'New Delhi') }}&departure={{ request.args.get('departure', '') }}&flight_option=with&persons={{ request.args.get('persons', 1) }}&initial_price={{ package_prices[p.id]['with_flight'] }}" class="btn btn-outline-primary btn-sm mt-2">View Details</a>
        </div>
        <div class="mb-2 flight-option flight-option-without" style="background:#f8fafc;border-radius:8px;padding:12px;">
            <div style="font-weight:600;color:#0077ff;">Without Flight</div>
            <div style="font-size:1.25rem;font-weight:700;">₹{{ "{:,}".format(package_prices[p.id]['without_flight']) }}</div>
            <a href="/package/{{ p.id }}?from_city={{ request.args.get('from_city', 'New Delhi') }}&departure={{ request.args.get('departure', '') }}&flight_option=without&persons={{ request.args.get('persons', 1) }}&initial_price={{ package_prices[p.id]['without_flight'] }}" class="btn btn-outline-primary btn-sm mt-2">View Details</a>
        </div>
    </div>
</div>
</div>
{% endfor %}
</div>
<script>
function showFlightOption(option) {
    // Toggle active button
    document.getElementById('filter-with-flight').classList.remove('active');
    document.getElementById('filter-without-flight').classList.remove('active');
    if (option === 'with') {
        document.getElementById('filter-with-flight').classList.add('active');
    } else {
        document.getElementById('filter-without-flight').classList.add('active');
    }
    // Show/hide price options
    document.querySelectorAll('.flight-option-with').forEach(el => {
        el.style.display = (option === 'with') ? 'block' : 'none';
    });
    document.querySelectorAll('.flight-option-without').forEach(el => {
        el.style.display = (option === 'without') ? 'block' : 'none';
    });
}
// Default: show "With Flight"
document.addEventListener('DOMContentLoaded', function() {
    showFlightOption('with');
});
</script>
{% endblock %}
